<!-- MainWindow.xaml -->
<Window x:Class="Client.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Cruise Management System" Height="650" Width="1100"
        WindowStartupLocation="CenterScreen"
        Background="#F6F8FA">

    <DockPanel>
        <!-- Toolbar za akcije -->
        <ToolBar DockPanel.Dock="Top" Background="#E3EAF2">
            <Button Content="Add Voyage" Command="{Binding AddVoyageCommand}" Margin="2" />
            <Button Content="Edit Voyage" Command="{Binding EditVoyageCommand}" Margin="2" />
            <Button Content="Delete Voyage" Command="{Binding DeleteVoyageCommand}" Margin="2" />
            <Separator />
            <Button Content="Add Ship" Command="{Binding AddShipCommand}" Margin="2" />
            <Button Content="Add Port" Command="{Binding AddPortCommand}" Margin="2" />
            <Separator />
            <Button Content="Undo" Command="{Binding UndoCommand}" Margin="2" />
            <Button Content="Redo" Command="{Binding RedoCommand}" Margin="2" />
        </ToolBar>

        <!-- Search box -->
        <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" Margin="10,8,10,8" Background="#F0F4F8">
            <TextBlock Text="Search:" VerticalAlignment="Center" Margin="0,0,5,0" FontWeight="Bold" />
            <TextBox Text="{Binding SearchTerm}" Width="220" Margin="0,0,5,0" />
            <Button Content="Search" Command="{Binding SearchCommand}" Margin="5,0,0,0" />
        </StackPanel>

        <!-- Glavni sadržaj -->
        <Grid Margin="10">
            <Grid.RowDefinitions>
                <RowDefinition Height="*" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>

            <!-- DataGrid za prikaz Voyages -->
            <DataGrid Grid.Row="0"
                      ItemsSource="{Binding Voyages}"
                      SelectedItem="{Binding SelectedVoyage}"
                      AutoGenerateColumns="False"
                      Margin="0,0,0,10"
                      IsReadOnly="True"
                      RowHeaderWidth="0"
                      SelectionMode="Single"
                      CanUserAddRows="False"
                      CanUserDeleteRows="False"
                      CanUserResizeRows="False"
                      HeadersVisibility="Column"
                      AlternatingRowBackground="#F5F7FA"
                      GridLinesVisibility="Horizontal"
                      BorderBrush="#D0D7DE"
                      BorderThickness="1">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Code" Binding="{Binding Code}" Width="100" />
                    <DataGridTextColumn Header="Departure" Binding="{Binding DepartureTime}" Width="120" />
                    <DataGridTextColumn Header="Arrival" Binding="{Binding ArrivalTime}" Width="120" />
                    <DataGridTextColumn Header="Ship" Binding="{Binding Ship.Name}" Width="120" />
                    <DataGridTextColumn Header="From" Binding="{Binding DeparturePort.Name}" Width="120" />
                    <DataGridTextColumn Header="To" Binding="{Binding ArrivalPort.Name}" Width="120" />
                    <DataGridTextColumn Header="Distance" Binding="{Binding Distance}" Width="80" />
                    <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="100" />
                    <DataGridTextColumn Header="Captain Message" Binding="{Binding CaptainMessage}" Width="200" />
                    <DataGridTemplateColumn Header="Simulate state" Width="120">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Button Content="Simulate"
                                        Command="{Binding DataContext.SimulateStateChangeCommand, RelativeSource={RelativeSource AncestorType=DataGrid}}"
                                        CommandParameter="{Binding}"
                                        Padding="4,2"
                                        Margin="2"
                                        Background="#D6EAF8"
                                        BorderBrush="#2980B9"
                                        BorderThickness="1" />
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                </DataGrid.Columns>
            </DataGrid>

            <!-- Panel za detalje selektovane plovidbe -->
            <Border Grid.Row="1" Padding="12" Background="#F8F9FB" BorderBrush="#D0D7DE" BorderThickness="1" CornerRadius="6">
                <StackPanel Orientation="Vertical">
                    <TextBlock Text="Details of the selected voyage:" FontWeight="Bold" FontSize="15" Margin="0,0,0,8" />
                    <TextBlock Text="{Binding SelectedVoyage.Code, StringFormat=Code: {0}}" FontSize="13" Margin="0,0,0,2" />
                    <TextBlock Text="{Binding SelectedVoyage.Status, StringFormat=Status: {0}}" FontSize="13" Margin="0,0,0,2" />
                    <TextBlock Text="{Binding SelectedVoyage.CaptainMessage, StringFormat=Captain message: {0}}" FontSize="13" Margin="0,0,0,2" />
                    <TextBlock Text="{Binding SelectedVoyage.Distance, StringFormat=Distance: {0} km}" FontSize="13" Margin="0,0,0,2" />
                </StackPanel>
            </Border>
        </Grid>
    </DockPanel>
</Window>